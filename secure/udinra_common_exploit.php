<?php

$udinra_nginx_secure_response .= 
	'##################################################'.PHP_EOL .
	'# Block common exploits '.PHP_EOL .	
	'##################################################'.PHP_EOL .
    'set $block_common_exploits 0;'.PHP_EOL .
    'if ($query_string ~ "(<|%3C).*script.*(>|%3E)") {'.PHP_EOL .
    '    set $block_common_exploits 1;'.PHP_EOL .
    '}'.PHP_EOL .
    'if ($query_string ~ "GLOBALS(=|\[|\%[0-9A-Z]{0,2})") {'.PHP_EOL .
    '    set $block_common_exploits 1;'.PHP_EOL .
    '}'.PHP_EOL .
    'if ($query_string ~ "_REQUEST(=|\[|\%[0-9A-Z]{0,2})") {'.PHP_EOL .
    '    set $block_common_exploits 1;'.PHP_EOL .
    '}'.PHP_EOL .
    'if ($query_string ~ "proc/self/environ") {'.PHP_EOL .
    '    set $block_common_exploits 1;'.PHP_EOL .
    '}'.PHP_EOL .
    'if ($query_string ~ "mosConfig_[a-zA-Z_]{1,21}(=|\%3D)") {'.PHP_EOL .
    '    set $block_common_exploits 1;'.PHP_EOL .
    '}'.PHP_EOL .
    'if ($query_string ~ "base64_(en|de)code\(.*\)") {'.PHP_EOL .
    '    set $block_common_exploits 1;'.PHP_EOL .
    '}'.PHP_EOL .
    'if ($block_common_exploits = 1) {'.PHP_EOL .
    '    return 403;'.PHP_EOL .
    '}'.PHP_EOL ;

?>